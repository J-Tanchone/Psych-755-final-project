<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jessica Tanchone and Miao Yu">

<title>Somatic Symptom Fatigue Project: Neural Network Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="Psych_755_final_project_files/libs/clipboard/clipboard.min.js"></script>
<script src="Psych_755_final_project_files/libs/quarto-html/quarto.js"></script>
<script src="Psych_755_final_project_files/libs/quarto-html/popper.min.js"></script>
<script src="Psych_755_final_project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Psych_755_final_project_files/libs/quarto-html/anchor.min.js"></script>
<link href="Psych_755_final_project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Psych_755_final_project_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Psych_755_final_project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Psych_755_final_project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Psych_755_final_project_files/libs/bootstrap/bootstrap-81e35ebdb4125010edbabe6010586085.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="apa-style.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#somatic-symptom-fatigue-project-neural-network-analysis" id="toc-somatic-symptom-fatigue-project-neural-network-analysis" class="nav-link active" data-scroll-target="#somatic-symptom-fatigue-project-neural-network-analysis"><span class="header-section-number">1</span> Somatic Symptom Fatigue Project: Neural Network Analysis</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">2</span> Introduction</a></li>
  <li><a href="#literature-review" id="toc-literature-review" class="nav-link" data-scroll-target="#literature-review"><span class="header-section-number">3</span> Literature review</a>
  <ul class="collapse">
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset"><span class="header-section-number">3.0.1</span> Dataset</a></li>
  <li><a href="#approach" id="toc-approach" class="nav-link" data-scroll-target="#approach"><span class="header-section-number">3.1</span> Approach</a></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">4</span> Data Preparation</a>
  <ul class="collapse">
  <li><a href="#variables-and-measures" id="toc-variables-and-measures" class="nav-link" data-scroll-target="#variables-and-measures"><span class="header-section-number">4.1</span> Variables and Measures</a>
  <ul class="collapse">
  <li><a href="#outcome-variable" id="toc-outcome-variable" class="nav-link" data-scroll-target="#outcome-variable"><span class="header-section-number">4.1.1</span> Outcome Variable</a></li>
  <li><a href="#psychological-predictors" id="toc-psychological-predictors" class="nav-link" data-scroll-target="#psychological-predictors"><span class="header-section-number">4.1.2</span> Psychological Predictors</a></li>
  <li><a href="#demographic-and-attitudinal-predictors" id="toc-demographic-and-attitudinal-predictors" class="nav-link" data-scroll-target="#demographic-and-attitudinal-predictors"><span class="header-section-number">4.1.3</span> Demographic and Attitudinal Predictors</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda"><span class="header-section-number">5</span> EDA</a>
  <ul class="collapse">
  <li><a href="#data-normalization" id="toc-data-normalization" class="nav-link" data-scroll-target="#data-normalization"><span class="header-section-number">5.1</span> Data Normalization</a></li>
  </ul></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation"><span class="header-section-number">6</span> Model Evaluation</a>
  <ul class="collapse">
  <li><a href="#tensorflow" id="toc-tensorflow" class="nav-link" data-scroll-target="#tensorflow"><span class="header-section-number">6.1</span> Tensorflow</a></li>
  <li><a href="#keras-3-pytorch" id="toc-keras-3-pytorch" class="nav-link" data-scroll-target="#keras-3-pytorch"><span class="header-section-number">6.2</span> Keras 3 + PyTorch</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">7</span> Discussion</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">8</span> Conclusion</a></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference"><span class="header-section-number">9</span> Reference</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Psych_755_final_project.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Somatic Symptom Fatigue Project: Neural Network Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jessica Tanchone and Miao Yu </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Invalid Date</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="somatic-symptom-fatigue-project-neural-network-analysis" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Somatic Symptom Fatigue Project: Neural Network Analysis</h1>
</section>
<section id="introduction" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Introduction</h1>
<p>The primary objective of this project is to predict the presence or absence of fatigue (Symptom 12) based on a set of psychosocial and demographic predictors. Fatigue is a common somatic symptom that can have multiple underlying causes, including psychological stress, sleep disturbances, and other health-related factors. Identifying key predictors of fatigue can help researchers better understand its risk factors and potentially inform targeted interventions.</p>
</section>
<section id="literature-review" class="level1 page-columns page-full" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Literature review</h1>
<p>Fatigue is often associated with significant reductions in quality of life and increased healthcare use. Prior research has identified multiple predictors of fatigue across clinical and community samples. In large population-based studies, fatigue has been significantly predicted by stressful life events, chronic illnesses, and psychological traits such as anxiety and neuroticism, with physical conditions explaining more variance than mental disorders alone <span class="citation" data-cites="creed2022">(<a href="#ref-creed2022" role="doc-biblioref">Creed, 2022</a>)</span>. These findings underscore the multidimensional nature of fatigue etiology.</p>
<div class="no-row-height column-margin column-container"><div id="ref-creed2022" class="csl-entry" role="listitem">
Creed, F. (2022). The predictors of somatic symptoms in a population sample: The lifelines cohort study. <em>Psychosomatic Medicine</em>, <em>84</em>(9), 1056–1066. <a href="https://doi.org/10.1097/PSY.0000000000001101">https://doi.org/10.1097/PSY.0000000000001101</a>
</div><div id="ref-tomenson2013" class="csl-entry" role="listitem">
Tomenson, B., Essau, C., Jacobi, F., Ladwig, K. H., Leiknes, K. A., Lieb, R., Meinlschmidt, G., McBeth, J., Rosmalen, J., Rief, W., &amp; Sumathipala, A. (2013). Total somatic symptom score as a predictor of health outcome in somatic symptom disorders. <em>British Journal of Psychiatry</em>, <em>203</em>(5), 373–380. <a href="https://doi.org/10.1192/bjp.bp.112.114405">https://doi.org/10.1192/bjp.bp.112.114405</a>
</div><div id="ref-clifford2024" class="csl-entry" role="listitem">
Clifford, C., Löwe, B., &amp; Kohlmann, S. (2024). Characteristics and predictors of persistent somatic symptoms in patients with cardiac disease. <em>Scientific Reports</em>, <em>14</em>(1), 25517. <a href="https://doi.org/10.1038/s41598-024-76554-z">https://doi.org/10.1038/s41598-024-76554-z</a>
</div></div><p>Symptom count has also been shown to be a reliable predictor of poor health outcomes and healthcare utilization, suggesting that modeling symptoms individually—rather than solely using aggregate diagnostic categories—may provide more nuanced insights <span class="citation" data-cites="tomenson2013">(<a href="#ref-tomenson2013" role="doc-biblioref">Tomenson et al., 2013</a>)</span>. Clinical studies further highlight that fatigue, as a persistent somatic symptom (PSS), is influenced by both medical and psychosocial factors. For example, in cardiac populations, fatigue severity is shaped by gender, age, depressive and anxiety symptoms, and disease burden, reinforcing the need for a biopsychosocial perspective in understanding this symptom <span class="citation" data-cites="clifford2024">(<a href="#ref-clifford2024" role="doc-biblioref">Clifford et al., 2024</a>)</span>.</p>
<p>Moreover, research from the SOMACROSS research unit has emphasized perceived stress as a modifiable risk factor for persistent somatic symptoms such as fatigue. Chronic stress exposure, particularly when perceived as uncontrollable, appears to exacerbate symptom experience and reporting <span class="citation" data-cites="lowe2022">(<a href="#ref-lowe2022" role="doc-biblioref">Löwe et al., 2022</a>)</span>. Collectively, these studies demonstrate that fatigue is a complex, multifactorial symptom with overlapping biological, psychological, and social determinants.</p>
<div class="no-row-height column-margin column-container"><div id="ref-lowe2022" class="csl-entry" role="listitem">
Löwe, B., Andresen, V., Van Den Bergh, O., Huber, T. B., Von Dem Knesebeck, O., Lohse, A. W., Nestoriuc, Y., Schneider, G., Schneider, S. W., Schramm, C., Ständer, S., Vettorazzi, E., Zapf, A., Shedden-Mora, M., &amp; Toussaint, A. (2022). Persistent SOMAtic symptoms ACROSS diseases—from risk factors to modification: Scientific framework and overarching protocol of the interdisciplinary SOMACROSS research unit (RU 5211). <em>BMJ Open</em>, <em>12</em>(1), e057596. <a href="https://doi.org/10.1136/bmjopen-2021-057596">https://doi.org/10.1136/bmjopen-2021-057596</a>
</div></div><section id="dataset" class="level3 page-columns page-full" data-number="3.0.1">
<h3 data-number="3.0.1" class="anchored" data-anchor-id="dataset"><span class="header-section-number">3.0.1</span> Dataset</h3>
<p>This analysis uses data from the Experience and Attitudes of Mental Health in International Students (EAMMi2) dataset published in the Journal of Open Psychology Data <span class="citation" data-cites="grahe2018">(<a href="#ref-grahe2018" role="doc-biblioref">Grahe et al., 2018</a>)</span>. The dataset includes responses from international university students on a variety of psychological and demographic measures.</p>
<div class="no-row-height column-margin column-container"><div id="ref-grahe2018" class="csl-entry" role="listitem">
Grahe, J. E., Chalk, H. M., Cramblet Alvarez, L. D., Faas, C. S., Hermann, A. D., &amp; McFall, J. P. (2018). Emerging adulthood measured at multiple institutions 2: The data. <em>Journal of Open Psychology Data</em>, <em>6</em>(1), 4. <a href="https://doi.org/10.5334/jopd.38">https://doi.org/10.5334/jopd.38</a>
</div></div><p><strong>Sample</strong>: Over 900 participants from 31 universities in the UK, EU, and beyond. Variables: Mental health screening tools (e.g., PHQ-15, PHQ-9, GAD-7), help-seeking attitudes, demographic information, and psychosocial measures. Outcome variable: Symptom 12 (fatigue), from the Patient Health Questionnaire (PHQ-15), recoded into a binary variable indicating presence (1) or absence (0) of the symptom. This dataset is particularly valuable because it captures a broad range of psychosocial and demographic factors, making it suitable for predictive modeling of somatic symptoms such as fatigue.</p>
</section>
<section id="approach" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="approach"><span class="header-section-number">3.1</span> Approach</h2>
<p>Type of model: A feed-forward neural network is used for classification. The model is trained to predict a binary outcome: fatigue present (1) vs.&nbsp;fatigue absent (0). Outcome variable: Symptom 12 (fatigue) is derived from the Patient Health Questionnaire (PHQ) dataset and is coded as a binary variable. Predictors: Psychosocial (e.g., stress levels, emotional well-being) and demographic variables (e.g., age, sex, education) serve as predictors. These variables were selected based on prior evidence linking them to fatigue and related symptoms.</p>
</section>
</section>
<section id="data-preparation" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Data Preparation</h1>
<div id="cell-4" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># !pip install torch</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># !pip install keras</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-5" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Core packages</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display tools</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># preprocessing and pipeline</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, GridSearchCV</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder, StandardScaler</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># models</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># feature selection</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> SelectKBest, f_classif</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># metrics</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> (</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    classification_report, roc_auc_score, confusion_matrix,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    RocCurveDisplay, accuracy_score, roc_curve, auc</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co"># neural networking</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Dense, Dropout</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.optimizers <span class="im">import</span> Adam</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> keras</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras <span class="im">import</span> layers, optimizers</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-6" class="cell" data-outputid="bb889f05-881e-49cc-f61d-dec8fce0fdfd">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>git clone https:<span class="op">//</span>J<span class="op">-</span>Tanchone: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<span class="op">@</span>github.com<span class="op">/</span>J<span class="op">-</span>Tanchone<span class="op">/</span>somatic<span class="op">-</span>symptom.git</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cloning into 'somatic-symptom'...
remote: Enumerating objects: 23, done.
remote: Counting objects: 100% (23/23), done.
remote: Compressing objects: 100% (16/16), done.
remote: Total 23 (delta 7), reused 21 (delta 5), pack-reused 0 (from 0)
Receiving objects: 100% (23/23), 7.49 MiB | 13.38 MiB/s, done.
Resolving deltas: 100% (7/7), done.
fatal: destination path 'somatic-symptom' already exists and is not an empty directory.</code></pre>
</div>
</div>
<p><a href="#tbl-main-experpt" class="quarto-xref">Table&nbsp;1</a> shows a sample of the original dataset, which includes all recorded variables.</p>
<div class="cell" data-outputid="e17ae4a9-d482-4913-85c8-6fe9a50f9e01" data-tbl-num="true">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_excel(<span class="st">"somatic-symptom/EAMMi2-Data1/EAMMi2-Data1.2.xlsx"</span>, sheet_name<span class="op">=</span><span class="st">"EAMMi2_Data"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>data.sample(<span class="dv">2</span>).transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-main-experpt" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-num="true" data-outputid="e17ae4a9-d482-4913-85c8-6fe9a50f9e01">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-main-experpt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: This table desplays random 2 rows of the data and transpose for eacy to read
</figcaption>
<div aria-describedby="tbl-main-experpt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="4">

  <div id="df-7c89939f-8a1f-4482-987a-47af0e9bff4e" class="colab-df-container">
    <div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">1946</th>
<th data-quarto-table-cell-role="th">419</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">StartDate</td>
<td>2016-11-16 10:52:47</td>
<td>2016-04-26 11:54:13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">EndDate</td>
<td>2016-11-16 11:36:02</td>
<td>2016-04-26 12:23:53</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Status</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Progress</td>
<td>99</td>
<td>100</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Duration (in seconds)</td>
<td>2595</td>
<td>1779</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Q81_Click Count</td>
<td>5.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">comments</td>
<td>I have complete this survey\n704</td>
<td>I have completed this survey</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">affiliation</td>
<td>riversidecc</td>
<td>depauw</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">response_bias_SUM</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">school_coded</td>
<td>riversidecc</td>
<td>depauw</td>
</tr>
</tbody>
</table>

<p>328 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7c89939f-8a1f-4482-987a-47af0e9bff4e')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7c89939f-8a1f-4482-987a-47af0e9bff4e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7c89939f-8a1f-4482-987a-47af0e9bff4e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-021efbf4-8ffa-4b1a-804e-f683ffda2964">
      <button class="colab-df-quickchart" onclick="quickchart('df-021efbf4-8ffa-4b1a-804e-f683ffda2964')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-021efbf4-8ffa-4b1a-804e-f683ffda2964 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
<div class="cell-output cell-output-display" data-execution_count="33">

  <div id="df-07b5b9a2-9991-4217-bfbe-86cc4e7d676e" class="colab-df-container">
    <div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">426</th>
<th data-quarto-table-cell-role="th">547</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">StartDate</td>
<td>2016-10-21 09:00:08</td>
<td>2016-03-31 06:56:20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">EndDate</td>
<td>2016-10-21 09:26:06</td>
<td>2016-03-31 07:10:23</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Status</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Progress</td>
<td>100</td>
<td>99</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Duration (in seconds)</td>
<td>1558</td>
<td>843</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Q81_Click Count</td>
<td>4.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">comments</td>
<td>I have completed this survey</td>
<td>I have completed this survey</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">affiliation</td>
<td>GeorgiaGwinett</td>
<td>gettysburg</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">response_bias_SUM</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">school_coded</td>
<td>GeorgiaGwinett</td>
<td>gettysburg</td>
</tr>
</tbody>
</table>

<p>328 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-07b5b9a2-9991-4217-bfbe-86cc4e7d676e')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-07b5b9a2-9991-4217-bfbe-86cc4e7d676e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-07b5b9a2-9991-4217-bfbe-86cc4e7d676e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-7979cf2f-0d2a-4421-a14c-d234ffb7fc1d">
      <button class="colab-df-quickchart" onclick="quickchart('df-7979cf2f-0d2a-4421-a14c-d234ffb7fc1d')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-7979cf2f-0d2a-4421-a14c-d234ffb7fc1d button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
</div>
</figure>
</div>
</div>
<p>This data has 328 columns and 3182 rows.</p>
<p>The EAMMi2 (Emerging Adulthood Measured at Multiple Institutions) dataset is a publicly available multi-site study involving over 3,000 undergraduate students across more than 30 institutions. It includes responses to a wide array of validated psychological and social questionnaires, such as the Patient Health Questionnaire (PHQ), Mindfulness scale, Perceived Stress Questionnaire, and others. The dataset also captures detailed demographic information, allowing for rich exploratory and predictive modeling of psychosocial constructs.</p>
<div id="cell-10" class="cell" data-outputid="2eb1194b-eb81-45fb-dbb9-49dad1808b1a">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>(3182, 328)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>(3182, 328)</code></pre>
</div>
</div>
<div id="cell-11" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>codebook <span class="op">=</span> pd.read_excel(<span class="st">"somatic-symptom/EAMMi2-Data1/EAMMi2-Data1.2-Codebook.xlsx"</span>).set_index(<span class="st">'Variable Name'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The variables listed in the codebook <a href="#tbl-factor_created-codebook" class="quarto-xref">Table&nbsp;2</a> represent composite measures that I constructed from raw item-level responses within the EAMMi2 dataset. These variables were designed to capture a range of psychological and demographic characteristics theoretically relevant to the experience of somatic symptoms. Psychological predictors include mean scores from validated self-report instruments, such as identity development (IDEA-8), perceived stress, social support, mindfulness, self-efficacy, need to belong, and subjective well-being. Additional variables reflect interpersonal dimensions, including narcissistic traits (NPI-13), interpersonal exploitativeness, and transgressions. Social media use was assessed through three dimensions: maintaining connections, forming new connections, and information seeking.</p>
<p>Demographic and attitudinal variables include disability identity, belief in the American dream, and the importance placed on marriage. I also recoded two categorical variables, parental marital status and sibling presence, to facilitate inclusion in statistical models. This curated and theoretically grounded set of predictors allows for a nuanced investigation of individual differences in somatic symptom reporting, particularly fatigue, in a young adult population.</p>
<div id="cell-13" class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode sibling variable</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'sibling_c'</span>] <span class="op">=</span> data[<span class="st">'sibling'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="op">-</span><span class="fl">0.5</span> <span class="cf">if</span> x <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> <span class="fl">0.5</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename and process marriage variables</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.rename(columns<span class="op">=</span>{<span class="st">'marriage2'</span>: <span class="st">'marriage_importance'</span>, <span class="st">'marriage5'</span>: <span class="st">'parental_marriage'</span>})</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.concat([data, pd.get_dummies(data[<span class="st">'parental_marriage'</span>].astype(<span class="st">'category'</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                                      prefix<span class="op">=</span><span class="st">'parental_marriage'</span>, drop_first<span class="op">=</span><span class="va">True</span>)], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute scale means</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>scales <span class="op">=</span> {</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'idea_m'</span>: [<span class="ss">f'IDEA_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">9</span>)],</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'moa_achievement_m'</span>: [<span class="ss">f'moa1#2_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>)] <span class="op">+</span> [<span class="ss">f'moa2#1_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>)],</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'moa_importance_m'</span>: [<span class="ss">f'moa2#1_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>)] <span class="op">+</span> [<span class="ss">f'moa2#2_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>)],</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stress_m'</span>: [<span class="ss">f'stress_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>)],</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'support_m'</span>: [<span class="ss">f'support_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">13</span>)],</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'belong_m'</span>: [<span class="ss">f'belong_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>)],</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mindful_m'</span>: [<span class="ss">f'mindful_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">16</span>)],</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'efficacy_m'</span>: [<span class="ss">f'efficacy_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>)],</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'npi_m'</span>: [<span class="ss">f'NPI</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">14</span>)],</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'exploit_m'</span>: [<span class="ss">f'exploit_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">4</span>)],</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'disability_m'</span>: [<span class="ss">f'Q10_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">16</span>)] <span class="op">+</span> [<span class="st">'Q11'</span>] <span class="op">+</span> [<span class="ss">f'Q14_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">7</span>)],</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'social_conn_m'</span>: [<span class="ss">f'SocMedia_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">6</span>)],</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'social_new_m'</span>: [<span class="ss">f'SocMedia_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">6</span>, <span class="dv">10</span>)],</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'social_info_m'</span>: [<span class="ss">f'SocMedia_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>, <span class="dv">12</span>)],</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">'swb_m'</span>: [<span class="ss">f'swb_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">7</span>)],</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'transgres_m'</span>: [<span class="ss">f'transgres_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">5</span>)],</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'usdream_m'</span>: [<span class="st">'usdream_1'</span>, <span class="st">'usdream_2'</span>]</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, items <span class="kw">in</span> scales.items():</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    valid_items <span class="op">=</span> [item <span class="cf">for</span> item <span class="kw">in</span> items <span class="cf">if</span> item <span class="kw">in</span> data.columns]</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    data[name] <span class="op">=</span> data[valid_items].mean(axis<span class="op">=</span><span class="dv">1</span>, skipna<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Select final columns</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>final_data <span class="op">=</span> data[[col <span class="cf">for</span> col <span class="kw">in</span> data.columns <span class="cf">if</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>                  col.endswith((<span class="st">'_m'</span>, <span class="st">'_c'</span>)) <span class="kw">or</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>                  col <span class="kw">in</span> [<span class="st">'marriage_importance'</span>, <span class="st">'parental_marriage'</span>] <span class="kw">or</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>                  col.startswith((<span class="st">'parental_marriage_'</span>, <span class="st">'sex_'</span>))]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="6a284c06-b734-4647-b591-26f328d912af" data-tbl-num="true" data-output-location="slide">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>codebook_created <span class="op">=</span> {</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'idea_m'</span>: <span class="st">"Mean score: Identity Exploration and Development Assessment (IDEA-8)"</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'moa_achievement_m'</span>: <span class="st">"Mean score: Markers of Adulthood - Achievement subscale"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'moa_importance_m'</span>: <span class="st">"Mean score: Markers of Adulthood - Importance subscale"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stress_m'</span>: <span class="st">"Mean score: Perceived Stress Scale"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'support_m'</span>: <span class="st">"Mean score: Perceived Social Support"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'belong_m'</span>: <span class="st">"Mean score: Need to Belong Scale"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mindful_m'</span>: <span class="st">"Mean score: Mindfulness Scale"</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'efficacy_m'</span>: <span class="st">"Mean score: Efficacy/Competence Scale"</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'npi_m'</span>: <span class="st">"Mean score: Narcissistic Personality Inventory (NPI-13)"</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'exploit_m'</span>: <span class="st">"Mean score: Interpersonal Exploitativeness Scale"</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'disability_m'</span>: <span class="st">"Mean score: Disability Identity &amp; Status items"</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'social_conn_m'</span>: <span class="st">"Mean score: Social Media Use - Maintaining Connections"</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'social_new_m'</span>: <span class="st">"Mean score: Social Media Use - Making New Connections"</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'social_info_m'</span>: <span class="st">"Mean score: Social Media Use - Information Seeking"</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'swb_m'</span>: <span class="st">"Mean score: Subjective Well-Being"</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'transgres_m'</span>: <span class="st">"Mean score: Interpersonal Transgressions"</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'usdream_m'</span>: <span class="st">"Mean score: American Dream (Importance and Belief in Achievability)"</span>,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sibling_c'</span>: <span class="st">"Recode: -0.5 = no siblings, +0.5 = at least one sibling"</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'marriage_importance'</span>: <span class="st">"Importance of getting married (1-5 scale)"</span>,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'parental_marriage'</span>: <span class="st">"Parental marriage status (categorical)"</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>codebook_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Variable'</span>: <span class="bu">list</span>(codebook_created.keys()),</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Description'</span>: <span class="bu">list</span>(codebook_created.values())</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>Markdown(codebook_df.to_markdown())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-factor_created-codebook" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-outputid="6a284c06-b734-4647-b591-26f328d912af" data-tbl-num="true" data-output-location="slide">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-factor_created-codebook-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: This is the codebook for all the variables I created.
</figcaption>
<div aria-describedby="tbl-factor_created-codebook-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="8">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 22%">
<col style="width: 73%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"></th>
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: left;">idea_m</td>
<td style="text-align: left;">Mean score: Identity Exploration and Development Assessment (IDEA-8)</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: left;">moa_achievement_m</td>
<td style="text-align: left;">Mean score: Markers of Adulthood - Achievement subscale</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">moa_importance_m</td>
<td style="text-align: left;">Mean score: Markers of Adulthood - Importance subscale</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: left;">stress_m</td>
<td style="text-align: left;">Mean score: Perceived Stress Scale</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: left;">support_m</td>
<td style="text-align: left;">Mean score: Perceived Social Support</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: left;">belong_m</td>
<td style="text-align: left;">Mean score: Need to Belong Scale</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: left;">mindful_m</td>
<td style="text-align: left;">Mean score: Mindfulness Scale</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: left;">efficacy_m</td>
<td style="text-align: left;">Mean score: Efficacy/Competence Scale</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: left;">npi_m</td>
<td style="text-align: left;">Mean score: Narcissistic Personality Inventory (NPI-13)</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: left;">exploit_m</td>
<td style="text-align: left;">Mean score: Interpersonal Exploitativeness Scale</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: left;">disability_m</td>
<td style="text-align: left;">Mean score: Disability Identity &amp; Status items</td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td style="text-align: left;">social_conn_m</td>
<td style="text-align: left;">Mean score: Social Media Use - Maintaining Connections</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: left;">social_new_m</td>
<td style="text-align: left;">Mean score: Social Media Use - Making New Connections</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: left;">social_info_m</td>
<td style="text-align: left;">Mean score: Social Media Use - Information Seeking</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: left;">swb_m</td>
<td style="text-align: left;">Mean score: Subjective Well-Being</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td style="text-align: left;">transgres_m</td>
<td style="text-align: left;">Mean score: Interpersonal Transgressions</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td style="text-align: left;">usdream_m</td>
<td style="text-align: left;">Mean score: American Dream (Importance and Belief in Achievability)</td>
</tr>
<tr class="even">
<td style="text-align: right;">17</td>
<td style="text-align: left;">sibling_c</td>
<td style="text-align: left;">Recode: -0.5 = no siblings, +0.5 = at least one sibling</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18</td>
<td style="text-align: left;">marriage_importance</td>
<td style="text-align: left;">Importance of getting married (1-5 scale)</td>
</tr>
<tr class="even">
<td style="text-align: right;">19</td>
<td style="text-align: left;">parental_marriage</td>
<td style="text-align: left;">Parental marriage status (categorical)</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="37">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 22%">
<col style="width: 73%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"></th>
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: left;">idea_m</td>
<td style="text-align: left;">Mean score: Identity Exploration and Development Assessment (IDEA-8)</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: left;">moa_achievement_m</td>
<td style="text-align: left;">Mean score: Markers of Adulthood - Achievement subscale</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">moa_importance_m</td>
<td style="text-align: left;">Mean score: Markers of Adulthood - Importance subscale</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: left;">stress_m</td>
<td style="text-align: left;">Mean score: Perceived Stress Scale</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: left;">support_m</td>
<td style="text-align: left;">Mean score: Perceived Social Support</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: left;">belong_m</td>
<td style="text-align: left;">Mean score: Need to Belong Scale</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: left;">mindful_m</td>
<td style="text-align: left;">Mean score: Mindfulness Scale</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: left;">efficacy_m</td>
<td style="text-align: left;">Mean score: Efficacy/Competence Scale</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: left;">npi_m</td>
<td style="text-align: left;">Mean score: Narcissistic Personality Inventory (NPI-13)</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: left;">exploit_m</td>
<td style="text-align: left;">Mean score: Interpersonal Exploitativeness Scale</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: left;">disability_m</td>
<td style="text-align: left;">Mean score: Disability Identity &amp; Status items</td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td style="text-align: left;">social_conn_m</td>
<td style="text-align: left;">Mean score: Social Media Use - Maintaining Connections</td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: left;">social_new_m</td>
<td style="text-align: left;">Mean score: Social Media Use - Making New Connections</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: left;">social_info_m</td>
<td style="text-align: left;">Mean score: Social Media Use - Information Seeking</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: left;">swb_m</td>
<td style="text-align: left;">Mean score: Subjective Well-Being</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td style="text-align: left;">transgres_m</td>
<td style="text-align: left;">Mean score: Interpersonal Transgressions</td>
</tr>
<tr class="odd">
<td style="text-align: right;">16</td>
<td style="text-align: left;">usdream_m</td>
<td style="text-align: left;">Mean score: American Dream (Importance and Belief in Achievability)</td>
</tr>
<tr class="even">
<td style="text-align: right;">17</td>
<td style="text-align: left;">sibling_c</td>
<td style="text-align: left;">Recode: -0.5 = no siblings, +0.5 = at least one sibling</td>
</tr>
<tr class="odd">
<td style="text-align: right;">18</td>
<td style="text-align: left;">marriage_importance</td>
<td style="text-align: left;">Importance of getting married (1-5 scale)</td>
</tr>
<tr class="even">
<td style="text-align: right;">19</td>
<td style="text-align: left;">parental_marriage</td>
<td style="text-align: left;">Parental marriage status (categorical)</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In addition to the psychological scales that were processed into mean scores, the second codebook <a href="#tbl-factor_unchanged-codebook" class="quarto-xref">Table&nbsp;3</a> describes the variables retained from the original EAMMi2 dataset without modification. These include sex (coded as 1 = male, 2 = female, 3 = other), edu (education level from high school to graduate degree), race (categorical coding for racial/ethnic identity), income (ordinal indicator of household income). The outcome variable physSx_12 (fatigue) was also retained in its original form before being recoded into a binary variable to indicate symptom presence (≥ 2 = symptom present). These variables were selected based on theoretical relevance to somatic symptom experiences and were not transformed beyond basic recoding or dummy encoding when necessary for modeling.</p>
<div class="cell" data-outputid="7b417e0c-9421-4892-9930-902a40850fec" data-tbl-num="true" data-output-location="slide">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Markdown(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    codebook</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    .loc[[<span class="st">'sex'</span>, <span class="st">'edu'</span>, <span class="st">'race'</span>, <span class="st">'income'</span>, <span class="st">'physSx_12'</span>]]</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    [[<span class="st">'Question text'</span>, <span class="st">'responses'</span>]]</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    .to_markdown()</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-factor_unchanged-codebook" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-outputid="7b417e0c-9421-4892-9930-902a40850fec" data-tbl-num="true" data-output-location="slide">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-factor_unchanged-codebook-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: This is the codebook of the variables retained without modification from the raw dataset.
</figcaption>
<div aria-describedby="tbl-factor_unchanged-codebook-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="9">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 48%">
<col style="width: 41%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable Name</th>
<th style="text-align: left;">Question text</th>
<th style="text-align: left;">responses</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sex</td>
<td style="text-align: left;">What is your gender?</td>
<td style="text-align: left;">1-male, 2-female, 3-other</td>
</tr>
<tr class="even">
<td style="text-align: left;">edu</td>
<td style="text-align: left;">Which of the following choices best describes your educational level/attainment?</td>
<td style="text-align: left;">1-high school, 9 completed graduate degree</td>
</tr>
<tr class="odd">
<td style="text-align: left;">race</td>
<td style="text-align: left;">What is your racial/ethnic group (check all the apply)? - Selected Choice</td>
<td style="text-align: left;">1-1White, 2-Black, 3-Hispanic, 4- Asian, 5 -Native American, 6-other</td>
</tr>
<tr class="even">
<td style="text-align: left;">income</td>
<td style="text-align: left;">Please indicate your current household income in U.S. dollars</td>
<td style="text-align: left;">1-rather not say, 2 -under 20,000, 9- over 1 million</td>
</tr>
<tr class="odd">
<td style="text-align: left;">physSx_12</td>
<td style="text-align: left;">Feeling tired or having low energy</td>
<td style="text-align: left;">1-not bothered at all, 3 bothered a lot</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="38">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 48%">
<col style="width: 41%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable Name</th>
<th style="text-align: left;">Question text</th>
<th style="text-align: left;">responses</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">sex</td>
<td style="text-align: left;">What is your gender?</td>
<td style="text-align: left;">1-male, 2-female, 3-other</td>
</tr>
<tr class="even">
<td style="text-align: left;">edu</td>
<td style="text-align: left;">Which of the following choices best describes your educational level/attainment?</td>
<td style="text-align: left;">1-high school, 9 completed graduate degree</td>
</tr>
<tr class="odd">
<td style="text-align: left;">race</td>
<td style="text-align: left;">What is your racial/ethnic group (check all the apply)? - Selected Choice</td>
<td style="text-align: left;">1-1White, 2-Black, 3-Hispanic, 4- Asian, 5 -Native American, 6-other</td>
</tr>
<tr class="even">
<td style="text-align: left;">income</td>
<td style="text-align: left;">Please indicate your current household income in U.S. dollars</td>
<td style="text-align: left;">1-rather not say, 2 -under 20,000, 9- over 1 million</td>
</tr>
<tr class="odd">
<td style="text-align: left;">physSx_12</td>
<td style="text-align: left;">Feeling tired or having low energy</td>
<td style="text-align: left;">1-not bothered at all, 3 bothered a lot</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The outcome variable physSx_12, which reflects the severity of a specific somatic symptom, shows a right-skewed distribution. The majority of responses fall in the moderate (2) and high (3) categories, with fewer individuals reporting mild symptoms (1). This class imbalance may influence model performance and will be considered during model evaluation.</p>
<p>For this project, we selected Item 12 (fatigue) from the PHQ somatic symptom inventory as the primary outcome of interest. This symptom was chosen due to its clinical relevance and sufficient variability in the sample, despite some imbalance in outcome distribution. A binary outcome variable was created to indicate whether the symptom was present (i.e., the participant reported experiencing fatigue “slightly” or “a lot,” score ≥ 2) or not present (“not at all,” score = 1). To account for the imbalance, classification models were adjusted using class weights. Separate logistic regression and random forest models were trained using mean scores from psychological scales and demographic variables as predictors to identify key risk factors associated with fatigue.</p>
<div id="cell-18" class="cell" data-outputid="19922ca2-c4d3-4a17-9b98-fd1bad2caa94">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"physSx_12"</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">physSx_12</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3.0</td>
<td>1552</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2.0</td>
<td>1220</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.0</td>
<td>405</td>
</tr>
</tbody>
</table>

</div><br><label><b>dtype:</b> int64</label>
</div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">physSx_12</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3.0</td>
<td>1552</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2.0</td>
<td>1220</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1.0</td>
<td>405</td>
</tr>
</tbody>
</table>

</div><br><label><b>dtype:</b> int64</label>
</div>
</div>
<section id="variables-and-measures" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="variables-and-measures"><span class="header-section-number">4.1</span> Variables and Measures</h2>
<section id="outcome-variable" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="outcome-variable"><span class="header-section-number">4.1.1</span> Outcome Variable</h3>
<p>The outcome variable were assessed using item 12 from the <strong>Patient Health Questionnaire (PHQ)</strong>. Responses were recoded into a binary variable, where a score of 2 or higher was considered symptomatic (coded as 1), and a score of 1 indicated no significant fatigue symptoms (coded as 0). This binary formulation was chosen due to its moderate class balance and clinical relevance.</p>
</section>
<section id="psychological-predictors" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="psychological-predictors"><span class="header-section-number">4.1.2</span> Psychological Predictors</h3>
<p>All psychological variables were computed as mean scores across item-level responses, provided that a sufficient proportion of items (≥70%) were present. The following scales were included:</p>
<ul>
<li><strong>IDEA-8</strong>: Identity exploration and development (8 items)</li>
<li><strong>Markers of Adulthood</strong>:
<ul>
<li>Achievement subscale (10 items)</li>
<li>Importance subscale (10 items)</li>
</ul></li>
<li><strong>Perceived Stress Scale</strong> (10 items)</li>
<li><strong>Perceived Social Support</strong> (12 items)</li>
<li><strong>Need to Belong Scale</strong> (10 items)</li>
<li><strong>Mindfulness Scale</strong> (15 items)</li>
<li><strong>Self-Efficacy/Competence</strong> (10 items)</li>
<li><strong>Narcissistic Personality Inventory (NPI-13)</strong> (13 items)</li>
<li><strong>Interpersonal Exploitativeness</strong> (3 items)</li>
<li><strong>Disability Identity and Status</strong> (combination of 22 items from Q10, Q11, and Q14)</li>
<li><strong>Social Media Use</strong>:
<ul>
<li>Maintaining connections (5 items)</li>
<li>Making new connections (4 items)</li>
<li>Seeking information (2 items)</li>
</ul></li>
<li><strong>Subjective Well-Being</strong> (6 items)</li>
<li><strong>Interpersonal Transgressions</strong> (4 items)</li>
<li><strong>Belief in and importance of the American Dream</strong> (2 items)</li>
</ul>
</section>
<section id="demographic-and-attitudinal-predictors" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="demographic-and-attitudinal-predictors"><span class="header-section-number">4.1.3</span> Demographic and Attitudinal Predictors</h3>
<ul>
<li><strong>Sex</strong> (male, female, other; categorical)</li>
<li><strong>Education level</strong></li>
<li><strong>Race/Ethnicity</strong></li>
<li><strong>Household income</strong></li>
<li><strong>School attended</strong></li>
<li><strong>Parental marriage status</strong> (recoded into categorical dummy variables)</li>
<li><strong>Siblings</strong> (recoded: -0.5 = no siblings, 0.5 = at least one sibling)</li>
<li><strong>Importance of marriage</strong> (single-item rating)</li>
</ul>
<p>These variables represent a theoretically grounded and diverse set of predictors for modeling somatic symptom risk, with particular focus on psychological and social functioning within a young adult population. <a href="#tbl-new-experpt" class="quarto-xref">Table&nbsp;4</a> shows the an experpt of the final data we are using.</p>
<div id="cell-20" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Binary outcome for fatigue:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 = symptom present (score ≥ 2)</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 = symptom not present (score = 1)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'fatigue_binary'</span>] <span class="op">=</span> (data[<span class="st">'physSx_12'</span>] <span class="op">&gt;=</span> <span class="dv">2</span>).astype(<span class="bu">int</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="ca44158a-6da0-430e-8ef9-79e851cecea3" data-tbl-num="true">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>constructed_vars <span class="op">=</span> [</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'idea_m'</span>, <span class="st">'moa_achievement_m'</span>, <span class="st">'moa_importance_m'</span>, <span class="st">'stress_m'</span>, <span class="st">'support_m'</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'belong_m'</span>, <span class="st">'mindful_m'</span>, <span class="st">'efficacy_m'</span>, <span class="st">'npi_m'</span>, <span class="st">'exploit_m'</span>, <span class="st">'disability_m'</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'social_conn_m'</span>, <span class="st">'social_new_m'</span>, <span class="st">'social_info_m'</span>, <span class="st">'swb_m'</span>, <span class="st">'transgres_m'</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'usdream_m'</span>, <span class="st">'sibling_c'</span>, <span class="st">'marriage_importance'</span>, <span class="st">'parental_marriage'</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>raw_demographics <span class="op">=</span> [<span class="st">'sex'</span>, <span class="st">'edu'</span>, <span class="st">'race'</span>, <span class="st">'income'</span>]</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>final_vars <span class="op">=</span> constructed_vars <span class="op">+</span> raw_demographics</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>final_data <span class="op">=</span> data[final_vars].copy()</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>final_data.sample(<span class="dv">2</span>).transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-new-experpt" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-num="true" data-outputid="ca44158a-6da0-430e-8ef9-79e851cecea3">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-new-experpt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: This table desplays random 2 rows of the new subset I created and transpose for eacy to read
</figcaption>
<div aria-describedby="tbl-new-experpt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="12">

  <div id="df-22a0dab7-c7dd-4050-8c74-4671867635c0" class="colab-df-container">
    <div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">642</th>
<th data-quarto-table-cell-role="th">2205</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">idea_m</td>
<td>3.75</td>
<td>2.75</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">moa_achievement_m</td>
<td>2.6</td>
<td>2.526316</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">moa_importance_m</td>
<td>2.75</td>
<td>2.736842</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">stress_m</td>
<td>2.6</td>
<td>3.1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">support_m</td>
<td>6.916667</td>
<td>6.75</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">belong_m</td>
<td>3.1</td>
<td>3.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">mindful_m</td>
<td>3.066667</td>
<td>3.933333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">efficacy_m</td>
<td>3.3</td>
<td>2.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">npi_m</td>
<td>1.538462</td>
<td>1.461538</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">exploit_m</td>
<td>4.666667</td>
<td>3.666667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">disability_m</td>
<td>1.318182</td>
<td>2.545455</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">social_conn_m</td>
<td>2.6</td>
<td>3.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">social_new_m</td>
<td>1.75</td>
<td>2.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">social_info_m</td>
<td>4.5</td>
<td>2.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">swb_m</td>
<td>6.666667</td>
<td>4.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">transgres_m</td>
<td>1.75</td>
<td>2.75</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">usdream_m</td>
<td>4.5</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">sibling_c</td>
<td>0.5</td>
<td>0.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">marriage_importance</td>
<td>4.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">parental_marriage</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">sex</td>
<td>1.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">edu</td>
<td>2.0</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">race</td>
<td>1</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">income</td>
<td>1.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-22a0dab7-c7dd-4050-8c74-4671867635c0')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-22a0dab7-c7dd-4050-8c74-4671867635c0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-22a0dab7-c7dd-4050-8c74-4671867635c0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-c55c145f-4a39-4711-a7b2-6a5ece6832aa">
      <button class="colab-df-quickchart" onclick="quickchart('df-c55c145f-4a39-4711-a7b2-6a5ece6832aa')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-c55c145f-4a39-4711-a7b2-6a5ece6832aa button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
<div class="cell-output cell-output-display" data-execution_count="41">

  <div id="df-751ea596-1aa6-4b2c-bbcf-e91e8eb38502" class="colab-df-container">
    <div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2087</th>
<th data-quarto-table-cell-role="th">1569</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">idea_m</td>
<td>4.0</td>
<td>3.125</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">moa_achievement_m</td>
<td>2.55</td>
<td>3.1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">moa_importance_m</td>
<td>2.85</td>
<td>3.05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">stress_m</td>
<td>3.4</td>
<td>3.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">support_m</td>
<td>3.083333</td>
<td>5.833333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">belong_m</td>
<td>4.1</td>
<td>3.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">mindful_m</td>
<td>3.866667</td>
<td>3.333333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">efficacy_m</td>
<td>2.0</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">npi_m</td>
<td>1.538462</td>
<td>1.692308</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">exploit_m</td>
<td>1.666667</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">disability_m</td>
<td>2.0</td>
<td>2.681818</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">social_conn_m</td>
<td>3.6</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">social_new_m</td>
<td>3.5</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">social_info_m</td>
<td>3.0</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">swb_m</td>
<td>1.333333</td>
<td>3.666667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">transgres_m</td>
<td>3.75</td>
<td>3.25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">usdream_m</td>
<td>3.5</td>
<td>4.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">sibling_c</td>
<td>0.5</td>
<td>0.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">marriage_importance</td>
<td>5.0</td>
<td>3.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">parental_marriage</td>
<td>2.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">sex</td>
<td>2.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">edu</td>
<td>2.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">race</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">income</td>
<td>2.0</td>
<td>5.0</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-751ea596-1aa6-4b2c-bbcf-e91e8eb38502')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-751ea596-1aa6-4b2c-bbcf-e91e8eb38502 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-751ea596-1aa6-4b2c-bbcf-e91e8eb38502');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-fb740203-7b1d-411a-a1fb-f75ef13efcb9">
      <button class="colab-df-quickchart" onclick="quickchart('df-fb740203-7b1d-411a-a1fb-f75ef13efcb9')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-fb740203-7b1d-411a-a1fb-f75ef13efcb9 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#tbl-summary" class="quarto-xref">Table&nbsp;5</a> presents descriptive statistics for all study variables. Across variables, missing data were minimal (0–25 cases). Standard deviations indicate varying levels of dispersion, with the lowest variability observed for <em>npi_m</em> (SD = 0.12) and the highest for <em>exploit_m</em> (SD = 1.37). Categorical variables such as sex and sibling count showed appropriate coding ranges. Income and education variables were right-skewed, with maximum values of 9. Overall, distributions and missingness were acceptable for further analyses.</p>
<div class="cell" data-outputid="669de7f3-7bf2-48cd-95b5-744f85c2f263" data-tbl-num="true">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>stats <span class="op">=</span> final_data.describe().transpose().<span class="bu">round</span>(<span class="dv">3</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>stats[<span class="st">'missing'</span>] <span class="op">=</span> final_data.isnull().<span class="bu">sum</span>()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>stats <span class="op">=</span> stats[[<span class="st">'count'</span>, <span class="st">'missing'</span>, <span class="st">'mean'</span>, <span class="st">'std'</span>, <span class="st">'min'</span>, <span class="st">'50%'</span>, <span class="st">'max'</span>]]</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-summary" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-tbl-num="true" data-outputid="669de7f3-7bf2-48cd-95b5-744f85c2f263">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: “Summary Statistics”
</figcaption>
<div aria-describedby="tbl-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="13">

  <div id="df-1ecbfd38-730e-4f9e-9c2f-56a08788b445" class="colab-df-container">
    <div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">missing</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">idea_m</td>
<td>3180.0</td>
<td>2</td>
<td>3.571</td>
<td>0.383</td>
<td>1.000</td>
<td>3.625</td>
<td>4.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">moa_achievement_m</td>
<td>3181.0</td>
<td>1</td>
<td>2.658</td>
<td>0.299</td>
<td>1.500</td>
<td>2.650</td>
<td>4.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">moa_importance_m</td>
<td>3180.0</td>
<td>2</td>
<td>2.778</td>
<td>0.296</td>
<td>1.650</td>
<td>2.800</td>
<td>4.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">stress_m</td>
<td>3177.0</td>
<td>5</td>
<td>3.266</td>
<td>0.408</td>
<td>1.000</td>
<td>3.300</td>
<td>5.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">support_m</td>
<td>3180.0</td>
<td>2</td>
<td>5.530</td>
<td>1.135</td>
<td>1.000</td>
<td>5.750</td>
<td>7.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">belong_m</td>
<td>3179.0</td>
<td>3</td>
<td>3.312</td>
<td>0.496</td>
<td>1.000</td>
<td>3.400</td>
<td>5.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">mindful_m</td>
<td>3177.0</td>
<td>5</td>
<td>3.710</td>
<td>0.843</td>
<td>1.133</td>
<td>3.733</td>
<td>6.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">efficacy_m</td>
<td>3180.0</td>
<td>2</td>
<td>3.125</td>
<td>0.450</td>
<td>1.000</td>
<td>3.100</td>
<td>4.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">npi_m</td>
<td>3179.0</td>
<td>3</td>
<td>1.545</td>
<td>0.124</td>
<td>1.000</td>
<td>1.538</td>
<td>2.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">exploit_m</td>
<td>3179.0</td>
<td>3</td>
<td>2.387</td>
<td>1.374</td>
<td>1.000</td>
<td>2.000</td>
<td>7.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">disability_m</td>
<td>3180.0</td>
<td>2</td>
<td>2.266</td>
<td>0.431</td>
<td>1.167</td>
<td>2.111</td>
<td>4.045</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">social_conn_m</td>
<td>3179.0</td>
<td>3</td>
<td>3.095</td>
<td>0.862</td>
<td>1.000</td>
<td>3.200</td>
<td>5.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">social_new_m</td>
<td>3179.0</td>
<td>3</td>
<td>3.052</td>
<td>0.970</td>
<td>1.000</td>
<td>3.000</td>
<td>5.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">social_info_m</td>
<td>3179.0</td>
<td>3</td>
<td>3.386</td>
<td>1.042</td>
<td>1.000</td>
<td>3.500</td>
<td>5.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">swb_m</td>
<td>3179.0</td>
<td>3</td>
<td>4.471</td>
<td>1.323</td>
<td>1.000</td>
<td>4.667</td>
<td>7.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">transgres_m</td>
<td>3175.0</td>
<td>7</td>
<td>2.050</td>
<td>1.062</td>
<td>1.000</td>
<td>1.750</td>
<td>7.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">usdream_m</td>
<td>3173.0</td>
<td>9</td>
<td>3.503</td>
<td>1.033</td>
<td>1.000</td>
<td>3.500</td>
<td>5.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">sibling_c</td>
<td>3182.0</td>
<td>0</td>
<td>0.404</td>
<td>0.294</td>
<td>-0.500</td>
<td>0.500</td>
<td>0.500</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">marriage_importance</td>
<td>3172.0</td>
<td>10</td>
<td>3.630</td>
<td>1.109</td>
<td>1.000</td>
<td>4.000</td>
<td>5.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">parental_marriage</td>
<td>3172.0</td>
<td>10</td>
<td>1.500</td>
<td>0.869</td>
<td>1.000</td>
<td>1.000</td>
<td>4.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">sex</td>
<td>3178.0</td>
<td>4</td>
<td>1.768</td>
<td>0.461</td>
<td>1.000</td>
<td>2.000</td>
<td>3.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">edu</td>
<td>3174.0</td>
<td>8</td>
<td>2.630</td>
<td>1.655</td>
<td>1.000</td>
<td>2.000</td>
<td>9.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">income</td>
<td>3157.0</td>
<td>25</td>
<td>3.544</td>
<td>2.299</td>
<td>1.000</td>
<td>3.000</td>
<td>9.000</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1ecbfd38-730e-4f9e-9c2f-56a08788b445')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1ecbfd38-730e-4f9e-9c2f-56a08788b445 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1ecbfd38-730e-4f9e-9c2f-56a08788b445');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-69eff673-2f43-40ab-a240-a219cdff50b0">
      <button class="colab-df-quickchart" onclick="quickchart('df-69eff673-2f43-40ab-a240-a219cdff50b0')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-69eff673-2f43-40ab-a240-a219cdff50b0 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_baba6c4f-5123-4303-a92d-bb3ca3bc7025">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('stats')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_baba6c4f-5123-4303-a92d-bb3ca3bc7025 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('stats');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
<div class="cell-output cell-output-display" data-execution_count="42">

  <div id="df-ea58e4d8-9c23-4d8a-a122-70fe591b462a" class="colab-df-container">
    <div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">missing</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">idea_m</td>
<td>3180.0</td>
<td>2</td>
<td>3.571</td>
<td>0.383</td>
<td>1.000</td>
<td>3.625</td>
<td>4.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">moa_achievement_m</td>
<td>3181.0</td>
<td>1</td>
<td>2.658</td>
<td>0.299</td>
<td>1.500</td>
<td>2.650</td>
<td>4.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">moa_importance_m</td>
<td>3180.0</td>
<td>2</td>
<td>2.778</td>
<td>0.296</td>
<td>1.650</td>
<td>2.800</td>
<td>4.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">stress_m</td>
<td>3177.0</td>
<td>5</td>
<td>3.266</td>
<td>0.408</td>
<td>1.000</td>
<td>3.300</td>
<td>5.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">support_m</td>
<td>3180.0</td>
<td>2</td>
<td>5.530</td>
<td>1.135</td>
<td>1.000</td>
<td>5.750</td>
<td>7.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">belong_m</td>
<td>3179.0</td>
<td>3</td>
<td>3.312</td>
<td>0.496</td>
<td>1.000</td>
<td>3.400</td>
<td>5.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">mindful_m</td>
<td>3177.0</td>
<td>5</td>
<td>3.710</td>
<td>0.843</td>
<td>1.133</td>
<td>3.733</td>
<td>6.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">efficacy_m</td>
<td>3180.0</td>
<td>2</td>
<td>3.125</td>
<td>0.450</td>
<td>1.000</td>
<td>3.100</td>
<td>4.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">npi_m</td>
<td>3179.0</td>
<td>3</td>
<td>1.545</td>
<td>0.124</td>
<td>1.000</td>
<td>1.538</td>
<td>2.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">exploit_m</td>
<td>3179.0</td>
<td>3</td>
<td>2.387</td>
<td>1.374</td>
<td>1.000</td>
<td>2.000</td>
<td>7.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">disability_m</td>
<td>3180.0</td>
<td>2</td>
<td>2.266</td>
<td>0.431</td>
<td>1.167</td>
<td>2.111</td>
<td>4.045</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">social_conn_m</td>
<td>3179.0</td>
<td>3</td>
<td>3.095</td>
<td>0.862</td>
<td>1.000</td>
<td>3.200</td>
<td>5.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">social_new_m</td>
<td>3179.0</td>
<td>3</td>
<td>3.052</td>
<td>0.970</td>
<td>1.000</td>
<td>3.000</td>
<td>5.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">social_info_m</td>
<td>3179.0</td>
<td>3</td>
<td>3.386</td>
<td>1.042</td>
<td>1.000</td>
<td>3.500</td>
<td>5.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">swb_m</td>
<td>3179.0</td>
<td>3</td>
<td>4.471</td>
<td>1.323</td>
<td>1.000</td>
<td>4.667</td>
<td>7.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">transgres_m</td>
<td>3175.0</td>
<td>7</td>
<td>2.050</td>
<td>1.062</td>
<td>1.000</td>
<td>1.750</td>
<td>7.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">usdream_m</td>
<td>3173.0</td>
<td>9</td>
<td>3.503</td>
<td>1.033</td>
<td>1.000</td>
<td>3.500</td>
<td>5.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">sibling_c</td>
<td>3182.0</td>
<td>0</td>
<td>0.404</td>
<td>0.294</td>
<td>-0.500</td>
<td>0.500</td>
<td>0.500</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">marriage_importance</td>
<td>3172.0</td>
<td>10</td>
<td>3.630</td>
<td>1.109</td>
<td>1.000</td>
<td>4.000</td>
<td>5.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">parental_marriage</td>
<td>3172.0</td>
<td>10</td>
<td>1.500</td>
<td>0.869</td>
<td>1.000</td>
<td>1.000</td>
<td>4.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">sex</td>
<td>3178.0</td>
<td>4</td>
<td>1.768</td>
<td>0.461</td>
<td>1.000</td>
<td>2.000</td>
<td>3.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">edu</td>
<td>3174.0</td>
<td>8</td>
<td>2.630</td>
<td>1.655</td>
<td>1.000</td>
<td>2.000</td>
<td>9.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">income</td>
<td>3157.0</td>
<td>25</td>
<td>3.544</td>
<td>2.299</td>
<td>1.000</td>
<td>3.000</td>
<td>9.000</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ea58e4d8-9c23-4d8a-a122-70fe591b462a')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ea58e4d8-9c23-4d8a-a122-70fe591b462a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ea58e4d8-9c23-4d8a-a122-70fe591b462a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-bcc3980f-3f10-4a8f-b8f6-fbf3f2f1acd7">
      <button class="colab-df-quickchart" onclick="quickchart('df-bcc3980f-3f10-4a8f-b8f6-fbf3f2f1acd7')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-bcc3980f-3f10-4a8f-b8f6-fbf3f2f1acd7 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_d3624ba5-5594-4aa5-b80c-4540637ce86b">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('stats')" title="Generate code using this dataframe." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"></path>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_d3624ba5-5594-4aa5-b80c-4540637ce86b button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('stats');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
</section>
<section id="eda" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> EDA</h1>
<p>We now proceed with the exploratory data analysis (EDA) to examine variable relationships and detect potential outliers patterns that may inform subsequent modeling.</p>
<p><a href="#fig-hist-numeric" class="quarto-xref">Figure&nbsp;1</a> displays the distributions of all numeric variables in the dataset. Most variables showed approximately normal or slightly skewed distributions (e.g., <em>mindful_m</em>, <em>efficacy_m</em>, <em>moa_achievement_m</em>), while others were highly skewed (e.g., <em>support_m</em>, <em>exploit_m</em>, <em>transgres_m</em>). Categorical variables (e.g., <em>sex</em>, <em>sibling_c</em>, <em>edu</em>) showed clear discrete patterns, reflecting limited response options. Some variables (e.g., <em>social_info_m</em>, <em>marriage_importance</em>) exhibited multimodal or uneven distributions, suggesting clustering of responses. Overall, the figure indicates variability in distribution shapes across measures, which may inform modeling strategies.</p>
<div class="cell" data-outputid="dcf11d3a-0e85-4ae2-d608-1f4bc6bba544" data-fig-num="true">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histograms for numeric variables</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>numeric_vars <span class="op">=</span> final_data.select_dtypes(include<span class="op">=</span>[<span class="st">'float64'</span>, <span class="st">'int64'</span>]).columns</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>final_data[numeric_vars].hist(figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">14</span>), bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">"Distribution of Numeric Variables"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-hist-numeric" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-fig-num="true" data-outputid="dcf11d3a-0e85-4ae2-d608-1f4bc6bba544">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-numeric-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div id="fig-hist-numeric-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-hist-numeric-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Psych_755_final_project_files/figure-html/fig-hist-numeric-output-1.png" class="img-fluid figure-img" data-ref-parent="fig-hist-numeric">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hist-numeric-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Distribution of numeric variables across the final dataset.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-hist-numeric-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-hist-numeric-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Psych_755_final_project_files/figure-html/fig-hist-numeric-output-2.png" id="fig-hist-numeric-2" class="img-fluid figure-img" data-ref-parent="fig-hist-numeric">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-hist-numeric-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-hist-numeric-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
</div>
<p><a href="#fig-corr-heatmap" class="quarto-xref">Figure&nbsp;2</a> presents a correlation matrix of numeric predictors, including the binary fatigue outcome. Most correlations were small to moderate, suggesting low multicollinearity among variables. Notably, <em>moa_achievement_m</em> and <em>moa_importance_m</em> were highly correlated (<em>r</em> = .85), indicating a strong relationship between these constructs. Moderate positive associations were observed between <em>support_m</em> and both <em>swb_m</em> (<em>r</em> = .47) and <em>belong_m</em> (<em>r</em> = .40). Correlations with <em>fatigue_binary</em> were generally weak, with the strongest negative correlation observed for <em>support_m</em> (<em>r</em> = −.17). These findings offer preliminary insights into variable associations and guide further analysis.</p>
<div class="cell" data-outputid="97590d28-6e2a-4a8c-8899-accc92dbcff8" data-fig-num="true">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># heatmap</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>final_data[<span class="st">'fatigue_binary'</span>] <span class="op">=</span> data[<span class="st">'fatigue_binary'</span>]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>selected_vars <span class="op">=</span> <span class="bu">list</span>(numeric_vars) <span class="op">+</span> [<span class="st">'fatigue_binary'</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">24</span>, <span class="dv">20</span>))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(final_data[selected_vars].corr(), annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">"coolwarm"</span>, fmt<span class="op">=</span><span class="st">".2f"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Correlation Matrix (Numeric Predictors)"</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-corr-heatmap" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-fig-num="true" data-outputid="97590d28-6e2a-4a8c-8899-accc92dbcff8">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-corr-heatmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div id="fig-corr-heatmap-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-corr-heatmap-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Psych_755_final_project_files/figure-html/fig-corr-heatmap-output-1.png" class="img-fluid figure-img" data-ref-parent="fig-corr-heatmap">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-corr-heatmap-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Correlation heatmap showing pairwise Pearson correlations. Stronger correlations appear in darker shades.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-corr-heatmap-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-corr-heatmap-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Psych_755_final_project_files/figure-html/fig-corr-heatmap-output-2.png" id="fig-corr-heatmap-2" class="img-fluid figure-img" data-ref-parent="fig-corr-heatmap">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-corr-heatmap-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-corr-heatmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2
</figcaption>
</figure>
</div>
</div>
<p>#Train-Test Split The dataset was split into training and test sets using a stratified sampling approach to preserve the class distribution of the binary fatigue outcome. A total of 3,132 complete cases were included, with 70% allocated to training (n = 2,192) and 30% to testing (n = 940). The target variable (fatigue_binary) was imbalanced, with 87.3% of participants coded as “1” and 12.7% coded as “0”. This stratified split ensures both sets maintain the original class proportions, supporting more reliable model evaluation.</p>
<div id="cell-31" class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> final_data.drop(columns<span class="op">=</span>[<span class="st">'fatigue_binary'</span>], errors<span class="op">=</span><span class="st">'ignore'</span>)  <span class="co"># safer drop</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">'fatigue_binary'</span>]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>model_data <span class="op">=</span> X.join(y.rename(<span class="st">'fatigue_binary'</span>)).dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-32" class="cell" data-outputid="15e6b90c-70cd-430b-ade7-2b40aef9aaff">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate X and y</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>X_clean <span class="op">=</span> model_data.drop(columns<span class="op">=</span><span class="st">'fatigue_binary'</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>y_clean <span class="op">=</span> model_data[<span class="st">'fatigue_binary'</span>]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Split</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    X_clean, y_clean,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    test_size<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">45</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    stratify<span class="op">=</span>y_clean</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Train shape:"</span>, X_train.shape)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test shape:"</span>, X_test.shape)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_clean.value_counts(normalize<span class="op">=</span><span class="va">True</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Train shape: (2192, 24)
Test shape: (940, 24)
fatigue_binary
1    0.872605
0    0.127395
Name: proportion, dtype: float64
Train shape: (2192, 24)
Test shape: (940, 24)
fatigue_binary
1    0.872605
0    0.127395
Name: proportion, dtype: float64</code></pre>
</div>
</div>
<section id="data-normalization" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="data-normalization"><span class="header-section-number">5.1</span> Data Normalization</h2>
<p>The data were preprocessed to prepare for model training. Non-numeric columns were identified and converted to numeric format, with commas replaced by decimal points. Missing values in the <em>race</em> variable were imputed using the most frequent category (mode). Following data cleaning, all predictor variables were standardized using <code>StandardScaler</code>, which was fit on the training set and applied to both training and test sets. This normalization step ensures that features are on a comparable scale, which is important for many machine learning algorithms.</p>
<div id="cell-34" class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify non-numeric columns before scaling</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>non_numeric_cols <span class="op">=</span> X_train.select_dtypes(exclude<span class="op">=</span>[<span class="st">'float64'</span>, <span class="st">'int64'</span>]).columns</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert identified columns to numeric, replacing commas with periods</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> non_numeric_cols:</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    X_train[col] <span class="op">=</span> X_train[col].astype(<span class="bu">str</span>).<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">'.'</span>, regex<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    X_test[col] <span class="op">=</span> X_test[col].astype(<span class="bu">str</span>).<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">'.'</span>, regex<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>X_train[non_numeric_cols] <span class="op">=</span> X_train[non_numeric_cols].<span class="bu">apply</span>(pd.to_numeric, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>X_test[non_numeric_cols] <span class="op">=</span> X_test[non_numeric_cols].<span class="bu">apply</span>(pd.to_numeric, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Impute missing values in the 'race' column with the mode (most frequent value)</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit imputer on training data and transform both train and test</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>imputer_race <span class="op">=</span> SimpleImputer(missing_values<span class="op">=</span>np.nan, strategy<span class="op">=</span><span class="st">'most_frequent'</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>X_train[<span class="st">'race'</span>] <span class="op">=</span> imputer_race.fit_transform(X_train[[<span class="st">'race'</span>]])</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>X_test[<span class="st">'race'</span>] <span class="op">=</span> imputer_race.transform(X_test[[<span class="st">'race'</span>]])</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Initialize the scaler</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Fit the scaler on the training data and transform both train and test</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>X_train_scaled <span class="op">=</span> scaler.fit_transform(X_train)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>X_test_scaled <span class="op">=</span> scaler.transform(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="model-evaluation" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Model Evaluation</h1>
<section id="tensorflow" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="tensorflow"><span class="header-section-number">6.1</span> Tensorflow</h2>
<p>Model performance was first evaluated using a neural network built with TensorFlow. Accuracy and area under the ROC curve (AUC) served as the primary evaluation metrics. A confusion matrix and classification report offered further insight into precision, recall, and F1 scores. Visual diagnostics—such as loss and accuracy over training epochs, a receiver operating characteristic (ROC) curve, and a histogram of predicted probabilities—were used to assess model fit, class discrimination, and prediction confidence.</p>
<div id="cell-36" class="cell" data-outputid="9078ea29-6658-4f58-d0a7-842ec6b4fbeb">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a simple model</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential([</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    Dense(<span class="dv">32</span>, activation<span class="op">=</span><span class="st">'relu'</span>, input_shape<span class="op">=</span>(X_train_scaled.shape[<span class="dv">1</span>],)),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    Dropout(<span class="fl">0.3</span>),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    Dense(<span class="dv">16</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    Dropout(<span class="fl">0.3</span>),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span>Adam(learning_rate<span class="op">=</span><span class="fl">0.001</span>), loss<span class="op">=</span><span class="st">'binary_crossentropy'</span>, metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for and handle potential NaN values in X_train_scaled</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> np.isnan(X_train_scaled).<span class="bu">any</span>():</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"NaN values found in X_train_scaled. Imputing with the mean of the scaled training data."</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    imputer <span class="op">=</span> SimpleImputer(missing_values<span class="op">=</span>np.nan, strategy<span class="op">=</span><span class="st">'mean'</span>)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    X_train_scaled_imputed <span class="op">=</span> imputer.fit_transform(X_train_scaled)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    X_train_scaled_imputed <span class="op">=</span> X_train_scaled</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Train</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    X_train_scaled_imputed, y_train,</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    validation_split<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    epochs<span class="op">=</span><span class="dv">30</span>,</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">32</span>,</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="dv">1</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/30</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>55/55 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.5356 - loss: 0.7520 - val_accuracy: 0.8702 - val_loss: 0.4350
Epoch 2/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8266 - loss: 0.4999 - val_accuracy: 0.8770 - val_loss: 0.3914
Epoch 3/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8644 - loss: 0.4208 - val_accuracy: 0.8770 - val_loss: 0.3754
Epoch 4/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8563 - loss: 0.4129 - val_accuracy: 0.8770 - val_loss: 0.3699
Epoch 5/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8747 - loss: 0.3844 - val_accuracy: 0.8770 - val_loss: 0.3664
Epoch 6/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8719 - loss: 0.3598 - val_accuracy: 0.8747 - val_loss: 0.3652
Epoch 7/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8608 - loss: 0.3810 - val_accuracy: 0.8770 - val_loss: 0.3666
Epoch 8/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8749 - loss: 0.3409 - val_accuracy: 0.8770 - val_loss: 0.3675
Epoch 9/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8853 - loss: 0.3474 - val_accuracy: 0.8747 - val_loss: 0.3675
Epoch 10/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8842 - loss: 0.3369 - val_accuracy: 0.8747 - val_loss: 0.3676
Epoch 11/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8822 - loss: 0.3347 - val_accuracy: 0.8747 - val_loss: 0.3683
Epoch 12/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8793 - loss: 0.3434 - val_accuracy: 0.8747 - val_loss: 0.3681
Epoch 13/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8782 - loss: 0.3351 - val_accuracy: 0.8747 - val_loss: 0.3699
Epoch 14/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8740 - loss: 0.3279 - val_accuracy: 0.8747 - val_loss: 0.3722
Epoch 15/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8834 - loss: 0.3210 - val_accuracy: 0.8770 - val_loss: 0.3724
Epoch 16/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8874 - loss: 0.3026 - val_accuracy: 0.8770 - val_loss: 0.3721
Epoch 17/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8731 - loss: 0.3356 - val_accuracy: 0.8770 - val_loss: 0.3731
Epoch 18/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8602 - loss: 0.3403 - val_accuracy: 0.8770 - val_loss: 0.3743
Epoch 19/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8820 - loss: 0.2933 - val_accuracy: 0.8770 - val_loss: 0.3743
Epoch 20/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8746 - loss: 0.3338 - val_accuracy: 0.8770 - val_loss: 0.3753
Epoch 21/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8850 - loss: 0.3162 - val_accuracy: 0.8770 - val_loss: 0.3758
Epoch 22/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8833 - loss: 0.3228 - val_accuracy: 0.8770 - val_loss: 0.3762
Epoch 23/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.8831 - loss: 0.3156 - val_accuracy: 0.8770 - val_loss: 0.3777
Epoch 24/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 5ms/step - accuracy: 0.8705 - loss: 0.3415 - val_accuracy: 0.8770 - val_loss: 0.3797
Epoch 25/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 1s 6ms/step - accuracy: 0.8703 - loss: 0.3108 - val_accuracy: 0.8770 - val_loss: 0.3806
Epoch 26/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 1s 6ms/step - accuracy: 0.8884 - loss: 0.2974 - val_accuracy: 0.8770 - val_loss: 0.3833
Epoch 27/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8870 - loss: 0.2984 - val_accuracy: 0.8815 - val_loss: 0.3831
Epoch 28/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8805 - loss: 0.3123 - val_accuracy: 0.8815 - val_loss: 0.3857
Epoch 29/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8838 - loss: 0.3115 - val_accuracy: 0.8770 - val_loss: 0.3860
Epoch 30/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8928 - loss: 0.3016 - val_accuracy: 0.8770 - val_loss: 0.3851
Epoch 1/30</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>55/55 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.6091 - loss: 0.6782 - val_accuracy: 0.8770 - val_loss: 0.4167
Epoch 2/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8324 - loss: 0.4794 - val_accuracy: 0.8770 - val_loss: 0.3785
Epoch 3/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8511 - loss: 0.4439 - val_accuracy: 0.8770 - val_loss: 0.3701
Epoch 4/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8664 - loss: 0.3841 - val_accuracy: 0.8770 - val_loss: 0.3665
Epoch 5/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8731 - loss: 0.3786 - val_accuracy: 0.8770 - val_loss: 0.3649
Epoch 6/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8735 - loss: 0.3475 - val_accuracy: 0.8770 - val_loss: 0.3633
Epoch 7/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8708 - loss: 0.3432 - val_accuracy: 0.8770 - val_loss: 0.3626
Epoch 8/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8640 - loss: 0.3829 - val_accuracy: 0.8770 - val_loss: 0.3621
Epoch 9/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8636 - loss: 0.3563 - val_accuracy: 0.8770 - val_loss: 0.3625
Epoch 10/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8483 - loss: 0.3773 - val_accuracy: 0.8770 - val_loss: 0.3638
Epoch 11/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8711 - loss: 0.3531 - val_accuracy: 0.8770 - val_loss: 0.3640
Epoch 12/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8802 - loss: 0.3385 - val_accuracy: 0.8770 - val_loss: 0.3648
Epoch 13/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8722 - loss: 0.3459 - val_accuracy: 0.8770 - val_loss: 0.3658
Epoch 14/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8640 - loss: 0.3355 - val_accuracy: 0.8770 - val_loss: 0.3669
Epoch 15/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8825 - loss: 0.3134 - val_accuracy: 0.8770 - val_loss: 0.3678
Epoch 16/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8718 - loss: 0.3273 - val_accuracy: 0.8770 - val_loss: 0.3689
Epoch 17/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8575 - loss: 0.3669 - val_accuracy: 0.8770 - val_loss: 0.3700
Epoch 18/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8839 - loss: 0.3222 - val_accuracy: 0.8747 - val_loss: 0.3705
Epoch 19/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.8714 - loss: 0.3402 - val_accuracy: 0.8747 - val_loss: 0.3705
Epoch 20/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 1s 6ms/step - accuracy: 0.8699 - loss: 0.3364 - val_accuracy: 0.8747 - val_loss: 0.3718
Epoch 21/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.8678 - loss: 0.3347 - val_accuracy: 0.8724 - val_loss: 0.3734
Epoch 22/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 7ms/step - accuracy: 0.8775 - loss: 0.3428 - val_accuracy: 0.8724 - val_loss: 0.3734
Epoch 23/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 1s 6ms/step - accuracy: 0.8784 - loss: 0.3136 - val_accuracy: 0.8747 - val_loss: 0.3747
Epoch 24/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8746 - loss: 0.3148 - val_accuracy: 0.8747 - val_loss: 0.3761
Epoch 25/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.9005 - loss: 0.2870 - val_accuracy: 0.8747 - val_loss: 0.3775
Epoch 26/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8729 - loss: 0.3448 - val_accuracy: 0.8724 - val_loss: 0.3786
Epoch 27/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8788 - loss: 0.3348 - val_accuracy: 0.8724 - val_loss: 0.3807
Epoch 28/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8757 - loss: 0.3115 - val_accuracy: 0.8724 - val_loss: 0.3825
Epoch 29/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8784 - loss: 0.3239 - val_accuracy: 0.8724 - val_loss: 0.3838
Epoch 30/30
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8719 - loss: 0.3211 - val_accuracy: 0.8702 - val_loss: 0.3842</code></pre>
</div>
</div>
<p><a href="#fig-loss-acc" class="quarto-xref">Figure&nbsp;3</a> shows the training and validation loss (left) and accuracy (right) across 30 training epochs for the neural network model. Training loss steadily decreased and stabilized, while validation loss plateaued early, indicating good convergence without overfitting. Accuracy for both training and validation sets increased rapidly and remained stable around 87%, suggesting the model generalized well to unseen data. These patterns reflect effective learning and a well-tuned model.</p>
<div class="cell" data-outputid="cc91ef95-77d6-4150-b0be-4671947800f4" data-fig-num="true">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot training and validation loss</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">'loss'</span>], label<span class="op">=</span><span class="st">'Train'</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">'val_loss'</span>], label<span class="op">=</span><span class="st">'Validation'</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Loss Over Epochs'</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot training and validation accuracy</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">'accuracy'</span>], label<span class="op">=</span><span class="st">'Train'</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">'val_accuracy'</span>], label<span class="op">=</span><span class="st">'Validation'</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Accuracy Over Epochs'</span>)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Accuracy'</span>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-loss-acc" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-fig-num="true" data-outputid="cc91ef95-77d6-4150-b0be-4671947800f4">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-loss-acc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div id="fig-loss-acc-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-loss-acc-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Psych_755_final_project_files/figure-html/fig-loss-acc-output-1.png" class="img-fluid figure-img" data-ref-parent="fig-loss-acc">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-loss-acc-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Training and Validation Loss and Accuracy Across Epochs for Neural Network Model
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-loss-acc-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-loss-acc-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Psych_755_final_project_files/figure-html/fig-loss-acc-output-2.png" id="fig-loss-acc-2" class="img-fluid figure-img" data-ref-parent="fig-loss-acc">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-loss-acc-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-loss-acc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3
</figcaption>
</figure>
</div>
</div>
<p>The neural network model achieved a test accuracy of 87.2% and an area under the curve (AUC) of 0.73, indicating good overall performance. However, the classification report revealed a critical limitation: the model failed to identify any instances of the minority class (label = 0), resulting in a precision, recall, and F1-score of 0.00 for that class. In contrast, the model demonstrated strong performance on the majority class (label = 1), with a recall of 1.00 and an F1-score of 0.93. These results suggest that while the model performs well in aggregate, it is highly imbalanced in its predictions and unable to detect the minority class, likely due to class imbalance in the training data.</p>
<div id="cell-40" class="cell" data-outputid="09e7240c-e023-4821-8009-d9ba7aae8acd">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict probabilities and class labels</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for and handle potential NaN values in X_test_scaled</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> np.isnan(X_test_scaled).<span class="bu">any</span>():</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"NaN values found in X_test_scaled. Imputing with the mean of the scaled training data."</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># A simple imputation strategy - using the mean of the scaled training data</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># You might want to consider a more sophisticated imputation method depending on your data</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    imputer <span class="op">=</span> SimpleImputer(missing_values<span class="op">=</span>np.nan, strategy<span class="op">=</span><span class="st">'mean'</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit on scaled training data to get the means, then transform test data</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    imputer.fit(X_train_scaled)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    X_test_scaled_imputed <span class="op">=</span> imputer.transform(X_test_scaled)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    X_test_scaled_imputed <span class="op">=</span> X_test_scaled</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>y_pred_prob <span class="op">=</span> model.predict(X_test_scaled_imputed).flatten()</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>y_pred_class <span class="op">=</span> (y_pred_prob <span class="op">&gt;=</span> <span class="fl">0.5</span>).astype(<span class="bu">int</span>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy and AUC</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test Accuracy:"</span>, accuracy_score(y_test, y_pred_class))</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test AUC:"</span>, roc_auc_score(y_test, y_pred_prob))</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix and classification report</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Confusion Matrix:</span><span class="ch">\n</span><span class="st">"</span>, confusion_matrix(y_test, y_pred_class))</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Classification Report:</span><span class="ch">\n</span><span class="st">"</span>, classification_report(y_test, y_pred_class))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>30/30 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step
Test Accuracy: 0.8712765957446809
Test AUC: 0.7371239837398373

Confusion Matrix:
 [[  3 117]
 [  4 816]]

Classification Report:
               precision    recall  f1-score   support

           0       0.43      0.03      0.05       120
           1       0.87      1.00      0.93       820

    accuracy                           0.87       940
   macro avg       0.65      0.51      0.49       940
weighted avg       0.82      0.87      0.82       940

30/30 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step
Test Accuracy: 0.875531914893617
Test AUC: 0.7396646341463415

Confusion Matrix:
 [[  4 116]
 [  1 819]]

Classification Report:
               precision    recall  f1-score   support

           0       0.80      0.03      0.06       120
           1       0.88      1.00      0.93       820

    accuracy                           0.88       940
   macro avg       0.84      0.52      0.50       940
weighted avg       0.87      0.88      0.82       940
</code></pre>
</div>
</div>
<p><a href="#fig-roc" class="quarto-xref">Figure&nbsp;4</a> presents the receiver operating characteristic (ROC) curve for the neural network model. The area under the curve (AUC) was 0.74, indicating fair discriminatory ability in distinguishing between participants with and without fatigue. The curve lies consistently above the diagonal reference line, suggesting the model performs better than random chance. However, the moderate AUC also reflects limitations in sensitivity, especially given the model’s failure to detect the minority class in the classification results.</p>
<div class="cell" data-outputid="6a6f1be1-ba98-4e30-989c-67f929c2e0b1" data-fig-num="true">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fpr, tpr, _ <span class="op">=</span> roc_curve(y_test, y_pred_prob)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>roc_auc <span class="op">=</span> auc(fpr, tpr)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">5</span>))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr, tpr, label<span class="op">=</span><span class="ss">f"AUC = </span><span class="sc">{</span>roc_auc<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"ROC Curve"</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"False Positive Rate"</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"True Positive Rate"</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-roc" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-fig-num="true" data-outputid="6a6f1be1-ba98-4e30-989c-67f929c2e0b1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-roc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div id="fig-roc-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-roc-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Psych_755_final_project_files/figure-html/fig-roc-output-1.png" class="img-fluid figure-img" data-ref-parent="fig-roc">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-roc-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Receiver Operating Characteristic (ROC) Curve for Neural Network Model
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-roc-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-roc-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Psych_755_final_project_files/figure-html/fig-roc-output-2.png" id="fig-roc-2" class="img-fluid figure-img" data-ref-parent="fig-roc">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-roc-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-roc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4
</figcaption>
</figure>
</div>
</div>
<p><a href="#fig-predicted-probabilities" class="quarto-xref">Figure&nbsp;5</a> displays the distribution of predicted probabilities for fatigue (class 1) in the test set. The histogram shows that most predictions were concentrated at the higher end of the probability range, particularly above 0.85. This indicates that the model was highly confident in predicting the majority class. The absence of low-probability predictions suggests poor discrimination for identifying the minority class (no fatigue), consistent with earlier findings from the confusion matrix and classification report. This skewed probability distribution further highlights the model’s bias toward the dominant class.</p>
<div class="cell" data-outputid="811f487c-d955-44cd-cf78-b61a9a4496ad" data-fig-num="true">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>plt.hist(y_pred_prob, bins<span class="op">=</span><span class="dv">30</span>, edgecolor<span class="op">=</span><span class="st">'k'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Predicted Probabilities (Test Set)"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Predicted Probability of Class 1 (Fatigue)"</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Count"</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-predicted-probabilities" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-fig-num="true" data-outputid="811f487c-d955-44cd-cf78-b61a9a4496ad">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-predicted-probabilities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div id="fig-predicted-probabilities-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-predicted-probabilities-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Psych_755_final_project_files/figure-html/fig-predicted-probabilities-output-1.png" class="img-fluid figure-img" data-ref-parent="fig-predicted-probabilities">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-predicted-probabilities-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Histogram of Predicted Probabilities for Fatigue Class (Test Set)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-predicted-probabilities-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-predicted-probabilities-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Psych_755_final_project_files/figure-html/fig-predicted-probabilities-output-2.png" id="fig-predicted-probabilities-2" class="img-fluid figure-img" data-ref-parent="fig-predicted-probabilities">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-predicted-probabilities-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-predicted-probabilities-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5
</figcaption>
</figure>
</div>
</div>
</section>
<section id="keras-3-pytorch" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="keras-3-pytorch"><span class="header-section-number">6.2</span> Keras 3 + PyTorch</h2>
<p>The second neural network model was built using the Keras Sequential API and consisted of an input layer, two hidden layers (with 64 and 32 units, respectively), ReLU activations, and dropout regularization (rate = 0.3) to reduce overfitting. The output layer used a sigmoid activation to support binary classification. The model was compiled with the Adam optimizer (learning rate = 0.001) and binary cross-entropy loss. It was trained for 20 epochs with a batch size of 32 and 20% of the training data reserved for validation. The final test accuracy achieved was 87.2%, indicating strong overall predictive performance on the fatigue classification task.</p>
<div id="cell-47" class="cell" data-outputid="eeb957e3-8ba6-4223-c1cd-4f573dfc3170">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> keras.Sequential([</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    layers.Input(shape<span class="op">=</span>(X_train.shape[<span class="dv">1</span>],)),</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    layers.Dense(<span class="dv">64</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    layers.Dropout(<span class="fl">0.3</span>),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    layers.Dense(<span class="dv">32</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    layers.Dropout(<span class="fl">0.3</span>),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    layers.Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    optimizer<span class="op">=</span>optimizers.Adam(learning_rate<span class="op">=</span><span class="fl">0.001</span>),</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    loss<span class="op">=</span><span class="st">'binary_crossentropy'</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    metrics<span class="op">=</span>[<span class="st">'accuracy'</span>]</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>model.fit(</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    X_train, y_train,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    validation_split<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    epochs<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">32</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 2s 17ms/step - accuracy: 0.7522 - loss: 0.6326 - val_accuracy: 0.8770 - val_loss: 0.3947
Epoch 2/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 8ms/step - accuracy: 0.8545 - loss: 0.4338 - val_accuracy: 0.8770 - val_loss: 0.3855
Epoch 3/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.8641 - loss: 0.4208 - val_accuracy: 0.8770 - val_loss: 0.3703
Epoch 4/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.8794 - loss: 0.3863 - val_accuracy: 0.8770 - val_loss: 0.3970
Epoch 5/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 1s 11ms/step - accuracy: 0.8870 - loss: 0.3620 - val_accuracy: 0.8770 - val_loss: 0.3983
Epoch 6/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 1s 7ms/step - accuracy: 0.8678 - loss: 0.3913 - val_accuracy: 0.8770 - val_loss: 0.3722
Epoch 7/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 1s 9ms/step - accuracy: 0.8500 - loss: 0.4187 - val_accuracy: 0.8770 - val_loss: 0.3707
Epoch 8/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 1s 8ms/step - accuracy: 0.8659 - loss: 0.3921 - val_accuracy: 0.8770 - val_loss: 0.3753
Epoch 9/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 1s 10ms/step - accuracy: 0.8719 - loss: 0.3655 - val_accuracy: 0.8770 - val_loss: 0.3695
Epoch 10/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 1s 6ms/step - accuracy: 0.8661 - loss: 0.3665 - val_accuracy: 0.8770 - val_loss: 0.3631
Epoch 11/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 1s 6ms/step - accuracy: 0.8823 - loss: 0.3525 - val_accuracy: 0.8770 - val_loss: 0.3703
Epoch 12/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 1s 5ms/step - accuracy: 0.8601 - loss: 0.3826 - val_accuracy: 0.8770 - val_loss: 0.3669
Epoch 13/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8730 - loss: 0.3540 - val_accuracy: 0.8770 - val_loss: 0.3655
Epoch 14/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8673 - loss: 0.3521 - val_accuracy: 0.8770 - val_loss: 0.3860
Epoch 15/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8545 - loss: 0.3755 - val_accuracy: 0.8770 - val_loss: 0.3712
Epoch 16/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8573 - loss: 0.3773 - val_accuracy: 0.8770 - val_loss: 0.3685
Epoch 17/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8726 - loss: 0.3533 - val_accuracy: 0.8770 - val_loss: 0.3655
Epoch 18/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8615 - loss: 0.3875 - val_accuracy: 0.8770 - val_loss: 0.3706
Epoch 19/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8752 - loss: 0.3368 - val_accuracy: 0.8770 - val_loss: 0.3713
Epoch 20/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8665 - loss: 0.3562 - val_accuracy: 0.8770 - val_loss: 0.3709</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>&lt;keras.src.callbacks.history.History at 0x7c9e2d796a50&gt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 2s 8ms/step - accuracy: 0.7598 - loss: 0.5908 - val_accuracy: 0.8770 - val_loss: 0.3844
Epoch 2/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8607 - loss: 0.4331 - val_accuracy: 0.8770 - val_loss: 0.3771
Epoch 3/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8621 - loss: 0.4247 - val_accuracy: 0.8770 - val_loss: 0.3816
Epoch 4/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8817 - loss: 0.3658 - val_accuracy: 0.8770 - val_loss: 0.3730
Epoch 5/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8667 - loss: 0.3892 - val_accuracy: 0.8770 - val_loss: 0.3881
Epoch 6/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8760 - loss: 0.3684 - val_accuracy: 0.8770 - val_loss: 0.3627
Epoch 7/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8603 - loss: 0.4037 - val_accuracy: 0.8770 - val_loss: 0.3617
Epoch 8/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8791 - loss: 0.3651 - val_accuracy: 0.8770 - val_loss: 0.3625
Epoch 9/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8637 - loss: 0.3748 - val_accuracy: 0.8770 - val_loss: 0.3662
Epoch 10/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8708 - loss: 0.3591 - val_accuracy: 0.8770 - val_loss: 0.3622
Epoch 11/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8712 - loss: 0.3673 - val_accuracy: 0.8770 - val_loss: 0.3642
Epoch 12/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8808 - loss: 0.3373 - val_accuracy: 0.8770 - val_loss: 0.3745
Epoch 13/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8755 - loss: 0.3494 - val_accuracy: 0.8770 - val_loss: 0.3648
Epoch 14/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8801 - loss: 0.3366 - val_accuracy: 0.8770 - val_loss: 0.3658
Epoch 15/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 5ms/step - accuracy: 0.8738 - loss: 0.3485 - val_accuracy: 0.8770 - val_loss: 0.3691
Epoch 16/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8747 - loss: 0.3499 - val_accuracy: 0.8770 - val_loss: 0.3643
Epoch 17/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8705 - loss: 0.3550 - val_accuracy: 0.8770 - val_loss: 0.3707
Epoch 18/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.8720 - loss: 0.3524 - val_accuracy: 0.8770 - val_loss: 0.3666
Epoch 19/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 1s 6ms/step - accuracy: 0.8803 - loss: 0.3262 - val_accuracy: 0.8770 - val_loss: 0.3673
Epoch 20/20
55/55 ━━━━━━━━━━━━━━━━━━━━ 1s 6ms/step - accuracy: 0.8725 - loss: 0.3395 - val_accuracy: 0.8770 - val_loss: 0.3693</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>&lt;keras.src.callbacks.history.History at 0x7c9e2d3355d0&gt;</code></pre>
</div>
</div>
<div id="cell-48" class="cell" data-outputid="367df827-8b98-496b-92ac-0c5bf00de693">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions (probabilities → binary)</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>y_pred_proba <span class="op">=</span> model.predict(X_test)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> (y_pred_proba <span class="op">&gt;</span> <span class="fl">0.5</span>).astype(<span class="bu">int</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>acc <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Model Accuracy:"</span>, acc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>30/30 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step
Model Accuracy: 0.8723404255319149
30/30 ━━━━━━━━━━━━━━━━━━━━ 0s 5ms/step
Model Accuracy: 0.8723404255319149</code></pre>
</div>
</div>
<p>The evaluation of the Keras neural network model was conducted on the test set, with missing values imputed using the mean of the training data where necessary. Predicted probabilities were converted to binary class labels using a 0.5 threshold. The model achieved a test accuracy of 87.2% and an AUC of 0.74, indicating strong overall predictive performance and acceptable class discrimination. These results are consistent with earlier evaluation metrics, further confirming the model’s effectiveness in identifying fatigue cases.</p>
<div id="cell-50" class="cell" data-outputid="da256211-12fc-4843-9f32-32b3a76bde49">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> (</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    accuracy_score, balanced_accuracy_score,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    roc_auc_score, f1_score, precision_score, recall_score</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1️⃣ Handle potential NaN values in X_test</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> np.isnan(X_test).<span class="bu">any</span>().<span class="bu">any</span>():</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"NaN values found in X_test. Imputing with the mean of the training data."</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    imputer <span class="op">=</span> SimpleImputer(missing_values<span class="op">=</span>np.nan, strategy<span class="op">=</span><span class="st">'mean'</span>)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    imputer.fit(X_train)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    X_test_imputed <span class="op">=</span> imputer.transform(X_test)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    X_test_imputed <span class="op">=</span> X_test</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 2️⃣ Predictions (probabilities → binary)</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>y_pred_proba <span class="op">=</span> model.predict(X_test_imputed).flatten()</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> (y_pred_proba <span class="op">&gt;</span> <span class="fl">0.5</span>).astype(<span class="bu">int</span>)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 3️⃣ Metrics</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>acc <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>balanced_acc <span class="op">=</span> balanced_accuracy_score(y_test, y_pred)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>auc <span class="op">=</span> roc_auc_score(y_test, y_pred_proba)</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> f1_score(y_test, y_pred)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>precision <span class="op">=</span> precision_score(y_test, y_pred)</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>recall <span class="op">=</span> recall_score(y_test, y_pred)</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 4️⃣ Print all metrics</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy: </span><span class="sc">{</span>acc<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Balanced Accuracy: </span><span class="sc">{</span>balanced_acc<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"AUC: </span><span class="sc">{</span>auc<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"F1 Score: </span><span class="sc">{</span>f1<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Precision: </span><span class="sc">{</span>precision<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Recall: </span><span class="sc">{</span>recall<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>30/30 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step 
Accuracy: 0.872
Balanced Accuracy: 0.500
AUC: 0.751
F1 Score: 0.932
Precision: 0.872
Recall: 1.000
30/30 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step 
Accuracy: 0.872
Balanced Accuracy: 0.500
AUC: 0.751
F1 Score: 0.932
Precision: 0.872
Recall: 1.000</code></pre>
</div>
</div>
<div id="cell-51" class="cell" data-outputid="0f7c01d5-2aae-4439-dd91-a16a0d9f6945">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert X_test to numpy if it's a dataframe</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>X_test_np <span class="op">=</span> X_test.values</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use SHAP DeepExplainer (works for Keras/TensorFlow and PyTorch)</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> shap.DeepExplainer(model, X_train.values[:<span class="dv">100</span>])  <span class="co"># use a subset as background</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>shap_values <span class="op">=</span> explainer.shap_values(X_test_np)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-52" class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mean absolute SHAP values per feature</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Access the SHAP values for the positive class (class 1)</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">isinstance</span>(shap_values, <span class="bu">list</span>):</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    shap_abs <span class="op">=</span> np.<span class="bu">abs</span>(shap_values[<span class="dv">0</span>]).mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    shap_abs <span class="op">=</span> np.<span class="bu">abs</span>(shap_values).mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure shap_abs is 1-dimensional</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>shap_abs <span class="op">=</span> shap_abs.flatten()</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>shap_importance <span class="op">=</span> pd.DataFrame({</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Feature'</span>: X_test.columns,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MeanAbsSHAP'</span>: shap_abs</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>}).sort_values(by<span class="op">=</span><span class="st">'MeanAbsSHAP'</span>, ascending<span class="op">=</span><span class="va">True</span>)  <span class="co"># ascending=True so smallest at top for horizontal plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>?@fig-SHAP</strong> presents the SHAP-based feature importance for the Keras neural network model. The results indicate that <em>swb_m</em> (subjective well-being) was the most influential predictor of fatigue, followed by <em>sex</em>, <em>usdream_m</em>, and <em>idea_m</em>. Other variables, such as <em>race</em>, <em>social_conn_m</em>, and <em>exploit_m</em>, contributed moderately, while features like <em>npi_m</em>, <em>sibling_c</em>, and <em>parental_marriage</em> had minimal impact. The SHAP values reflect the average contribution of each feature to the model’s predictions, highlighting the relative dominance of well-being and demographic factors in predicting fatigue.</p>
<div class="cell" data-outputid="8689644f-e752-4d9d-ac2b-fae152a6e41f" data-fig-num="true">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>plt.barh(shap_importance[<span class="st">'Feature'</span>], shap_importance[<span class="st">'MeanAbsSHAP'</span>], color<span class="op">=</span><span class="st">'skyblue'</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Mean Absolute SHAP Value (Feature Importance)"</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Feature Importance (SHAP)"</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-shap" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-fig-num="true" data-outputid="8689644f-e752-4d9d-ac2b-fae152a6e41f">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-shap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div id="fig-shap-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-shap-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Psych_755_final_project_files/figure-html/fig-shap-output-1.png" class="img-fluid figure-img" data-ref-parent="fig-shap">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-shap-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Feature Importance Based on SHAP Values for the Keras Neural Network Model
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-shap-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-shap-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Psych_755_final_project_files/figure-html/fig-shap-output-2.png" id="fig-shap-2" class="img-fluid figure-img" data-ref-parent="fig-shap">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-shap-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-shap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="discussion" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Discussion</h1>
<p>This project aimed to predict the presence of fatigue (Symptom 12) using psychosocial and demographic predictors through multiple supervised machine learning approaches, including neural networks. The models achieved moderate predictive accuracy, but early neural network models showed highly skewed probability distributions, with most predictions near 1.0. This suggests overconfidence and poor probability calibration, likely influenced by class imbalance. A refined neural network that incorporated dropout and early stopping displayed a more balanced probability distribution and better calibration, improving generalization.</p>
<p>These findings highlight the importance of evaluating calibration and using metrics beyond raw accuracy, such as balanced accuracy and F1 score, when class imbalance is present. Future work should explore probability calibration techniques and richer data sources to enhance prediction quality. Clinically, better-calibrated models could support early identification of individuals at risk for fatigue, allowing for more targeted interventions.</p>
</section>
<section id="conclusion" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Conclusion</h1>
<p>The models showed moderate accuracy in predicting fatigue, with the refined neural network providing the best-calibrated results. Class imbalance and overconfident predictions limited overall performance. Future work should focus on improving calibration, addressing imbalance, and testing on independent datasets to strengthen reliability.</p>
</section>
<section id="reference" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Reference</h1>

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>